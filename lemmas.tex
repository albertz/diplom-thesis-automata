%!TEX root =  index.tex
\section{Lemmas}

\subsection{piece-wise testable}

\begin{thm}
\[ \BC \ext \Lang^* (\PT) = \BC \lim \Lang^* (\PT) \]
\end{thm}

\begin{proof}

$L$ piece-wise testable $\Leftrightarrow$ $L$ is a boolean algebra of $\Sigma^* a_1 \Sigma^* a_2 \dotsb a_n \Sigma^*$
\\

$\subseteq$: It is sufficient to show $\ext(\Lang^* (\PT)) \subseteq \BC \lim \Lang^* (\PT)$.

By complete induction:
\begin{align*}
& \ext(\Sigma^* a_1 \Sigma^* a_2 \dotsb a_n \Sigma^*) = \Sigma^* a_1 \Sigma^* a_2 \dotsb a_n \Sigma^\omega = \lim(\Sigma^* a_1 \Sigma^* a_2 \dotsb a_n \Sigma^*) \\
& \ext( \neg ( \Sigma^* a_1 \Sigma^* a_2 \dotsb a_n \Sigma^* )) = \Sigma^\omega = \lim( \Sigma^* ) \\
& \ext( \emptyset ) = \emptyset = \lim(\emptyset)
\end{align*}

It is sufficient to show negation only for such ground terms because we can always push the negation down.
\begin{align*}
& \ext(A \cup B) = \ext(A) \cup \ext(B) \\
& \ext(A \cap B) = \ext(A) \cap \ext(B)
\end{align*}

This makes the induction complete.
\\

$\supseteq$: It is sufficient to show $\lim(\Lang^* (\PT)) \subseteq \BC \ext \Lang^* (\PT)$.
\begin{align*}
& \lim(\emptyset) = \ext(\emptyset), \ \lim(\Sigma^* a_1 \Sigma^* a_2 \dotsb a_n \Sigma^*) = \ext(\Sigma^* a_1 \Sigma^* a_2 \dotsb a_n \Sigma^*) \ \ \text{(see above)} \\
& \begin{aligned}
\lim( \neg ( \Sigma^* a_1 \Sigma^* a_2 \dotsb a_n \Sigma^* ) ) & = \Set{ \alpha \in \Sigma^\omega }{ \exists^\omega n \colon \alpha [0,n] \notin \Sigma^* a_1 \Sigma^* a_2 \dotsb a_n \Sigma^* } \\
& = \Set{ \alpha \in \Sigma^\omega }{ \forall n \colon \alpha [0,n] \notin \Sigma^* a_1 \Sigma^* a_2 \dotsb a_n \Sigma^* } \\
& = \neg \ext( \Sigma^* a_1 \Sigma^* a_2 \dotsb a_n \Sigma^* )
\end{aligned} \\
& \begin{aligned}
\lim(A \cup B) & = \Set{ \alpha \in \Sigma^\omega }{ \exists^\omega n \colon \alpha[0,n] \in A \cup B } = \lim(A) \cup \lim(B) \\
\lim(A \cap B) & = \Set{ \alpha \in \Sigma^\omega }{ \exists^\omega n \colon \alpha[0,n] \in A \cap B } \\
\intertext{and because $A,B$ are piece-wise testable}
& = \Set{ \alpha \in \Sigma^\omega }{ \exists n : \forall m > n \colon \alpha[0,m] \in A \cap B } = \lim(A) \cap \lim(B)
\end{aligned}
\end{align*}

\end{proof}


\subsection{extension of $\Lang^*(\mathrm{FO[+1]})$}

\begin{thm}
\[ \Lang^\omega (\mathrm{FO[+1]}) = \BC \ext \Lang^*(\mathrm{FO[+1]}) \]
\end{thm}

\begin{proof}
From \ref{LangAutLogic}{Theorem 4.8}, we know that each formular in FO[+1] is equivalent (for both finite and infinite words) to a boolean combination of statements ``sphere $\sigma \in \Sigma^+$ occurs $\geq n$ times''. That statement can be expressed by a sentence of the form
\[ \psi := \exists \overline{x_1} \dotsb \exists \overline{x_n} \varphi(\overline{x_1}, \dotsb, \overline{x_n}) \]
where each $\overline{x_i}$ is a $\abs{\sigma}$-tuple of variables and the formula $\varphi$ states:
\[
\bigwedge_{i,j \in \underline{n},\atop { i \neq j,\atop k,l \in \underline{\abs{\sigma}}}} x_{i,k} \neq x_{j,l}
\wedge \bigwedge_{i \in \underline{n},\atop k \in \underline{\abs{\sigma}-1}} x_{i,k+1} = x_{i,k} + 1
\wedge \bigwedge_{i \in \underline{n},\atop k \in \underline{\abs{\sigma}}} Q_{\sigma_k} x_{i,k}
\]
For $\psi$, we have:
\[ \alpha \models \psi \Leftrightarrow \exists n \colon \alpha[0,n] \models \psi \ \ \text{for all } \alpha \in \Sigma^\omega , \]
i.e.
\[ L^\omega(\psi) = \ext L^*(\psi) . \]
Any formular in FO[+1] can be expressed as a boolean combination of $\psi$-like formular. With
\begin{align*}
& L^\omega(\neg \psi) = \neg L^\omega(\psi) \\
& L^\omega(\psi_1 \wedge \psi_2) = L^\omega(\psi_1) \cap L^\omega(\psi_2) \\
& L^\omega(\psi_1 \vee \psi_2) = L^\omega(\psi_1) \cup L^\omega(\psi_2)
\end{align*}
we get:
\[ \Lang^\omega(\mathrm{FO[+1]}) = \BC \ext \Lang^*(\mathrm{FO[+1]}). \]

\end{proof}


