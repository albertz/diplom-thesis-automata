\section{Results on concrete $*$-language classes}
\label{concrete-results}

%\subsection{Overview}
%...
In \cref{chapter:regOmegaLangs}, we already showed many results for the different $\omega$-language classes constructed based on $\Langreg$. Mainly, those are the strict inclusions as shown in the diagram in \cref{regomega-diagram}.

In \cref{general-results}, we found some general conditions on abritrary $*$-language classes $\Lang$ under which the inclusion diagram stays the same. We also gave other conditions on $\Lang$ under which the diagram becomes different or other properties change.

We will now study some concrete well-known $*$-language classes and try to apply the results from \cref{general-results} as well as study some properties individually.

%S15/S151: overview, hierarchy

\subsection{Starfree regular languages}
%S18: def
The set of \defword{star-free $*$-languages} $\Lang(\mathtext{starfree})$ is defined as the smallest set $\Lang = \Lang(\mathtext{starfree})$ with
\begin{itemize}
\item[(a)] $\Set{a} \in \Lang$ for all $a \in \Sigma$,
\item[(b)] $\Lang$ is closed under boolean operations,
\item[(c)] $\Lang$ is closed under concatenation.
\end{itemize}
See \cite[Section 2.2]{ConcHierR104} for further references.

This class is also equivalent to the set of $\mathrm{FO[<]}$-definable languages. %TODO: ref
%W161,S210,S211,S101a,S51
% R107: some characterization
%In \cite[Theorem 3.2]{CombR107}, we see that
%\[  \Lang^\omega(\Set{}) ... \]

First, we start with some specific study on this language class.

%S210:
\begin{theorem}
\[ \Lang^\omega (\mathrm{FO[<]}) = \BC \lim \Lang^*(\mathrm{FO[<]}) \]
\begin{proof}
Let $\varphi \in \mathrm{FO[<]}$. By the \cite[Normal Form Theorem (4.4)]{CombR107} there are bounded formulas $\varphi_1(y),\dotsb,\varphi_r(y),\psi_1(y),\dotsb,\psi_r(y)$ such that for all $\alpha \in \Sigma^\omega$:
\[ \alpha \models \varphi \Leftrightarrow \alpha \models \bigvee_{i=1}^r \left( \forall x \exists y > x \colon \varphi_i (y) \right) \wedge \neg \left( \forall x \exists y > x \colon \psi_i (y) \right) \]
Thus:
\[
\alpha \models \varphi \Leftrightarrow \bigvee_{i=1}^r
\underbrace{ \left( \alpha \models \forall x \exists y > x \colon \varphi_i (y) \right) }_
{\mathclap{\quad\quad \begin{aligned}
& \Leftrightarrow \forall x \exists y > x \colon \alpha[0,n] \models \varphi_i(\omega) \\
& \Leftrightarrow \exists^\omega n \colon \alpha[0,n] \models \varphi_i(\omega) \\
& \Leftrightarrow \alpha \in \lim L^*( \varphi_i(\omega) )
\end{aligned}}}
\wedge \neg \left( \alpha \models \forall x \exists y > x \colon \psi_i (y) \right)
\]
where $\varphi_i(\omega)$ stands for $\varphi_i$ with all bounds removed.
I.e. we have
\[ L^\omega(\varphi) = \bigcup_{i=1}^r \lim( L^* (\varphi_i (\omega)) \cap \neg \lim( L^* (\psi_i (\omega))) , \]
and thus
\[ L^\omega(\varphi) \in \BC \lim \Lang^* (\mathrm{FO[<]}) . \]
We have prooved the $\subseteq$-direction. For $\supseteq$:
\begin{align*}
& \alpha \in \lim( L^*(\varphi) ) \\
\Leftrightarrow \ & \exists^\omega n \colon \alpha[0,n] \models \varphi \\
\Leftrightarrow \ & \alpha \models \forall x \exists y > x \colon \varphi(y) \\
\Leftrightarrow \ & \alpha \in L^\omega ( \forall \exists y > x \colon \varphi(y) )
\end{align*}
where $\varphi(y)$ stands for $\varphi$ with all variables bounded by $y$.
I.e.
\[ \lim \Lang^* (\mathrm{FO[<]}) \subseteq \Lang^\omega (\mathrm{FO[<]}) , \]
and thus also
\[ \BC \lim \Lang^* (\mathrm{FO[<]}) \subseteq \Lang^\omega (\mathrm{FO[<]}) . \]
Thus we have prooved the equality.
\end{proof}
\end{theorem}

%S211:
\begin{theorem}
\[ \BC \ext \Lang^*( \mathrm{FO[<]} ) \subsetneqq \BC \lim \Lang^* ( \mathrm{FO[<]} ) \]
\begin{proof}
$\subseteq$: $L \subset \Sigma^\omega \text{ starfree } \ \Rightarrow\ L \Sigma^\omega \in \lim( \Lang^*( \mathrm{FO[<]} ) )$

$\neq$:
\begin{align*}
& L := (\Sigma^* a)^\omega \\
\Rightarrow \ & L = \lim( (\Sigma^* a)^* ) \\
\Rightarrow \ & L = L^\omega(\exists^\omega x : Q_a x)
\end{align*}
And we have $L \notin \BC \ext \Lang^* (\mathrm{FO[<]})$.
\end{proof}
\end{theorem}

%S101a:
$\Set{a} \in \Lang$. $a \Sigma^* \in \Lang$, thus $a\Sigma^\omega = \ext(\Set{a}) = \dext{a\Sigma^*}$. I.e. $\ext \cap \dext \Lang \ne \emptyset$.

$\Lang^*( \mathrm{FO[<]} )$ is obviously \emph{closed under negation, suffix-independence, union and alphabet permutation}.

We can also see that $\Lang^*( \mathrm{FO[<]} )$ is \emph{closed under change of final states}. %TODO: argue

$L_a := \Sigma^* a \in \Lang$ is a $\ext$-$\dext$-separating and $\lim$-$\dlim$-separating language.

Thus, with \cref{gen:main-theorem-inclusions}, we get
\[ \ext \cap \dext \Lang \subsetneqq
\ext \cup \dext \Lang \subsetneqq
\BC \ext \Lang =
\lim \cap \dlim \Lang \subsetneqq
\lim \cup \dlim \Lang \subsetneqq
\BC \lim \Lang . \]


\subsection{Piecewise testable languages}
%S19: def
\label{lang:PT}
Let $u,v \in \Sigma^*$. For $n \in \N$, define the congruence relation $\simeq_{\PT_n}$:
\[ u \simeq_{\PT_n} v \ \ \ :\Leftrightarrow \ \ \ \operatorname{Subwords}_{\le n}(u) = \operatorname{Subwords}_{\le n}(v) , \]
where
\[ \operatorname{Subwords}_{\le n}(u) := \Set{w \in \Sigma^{\le n}}{\text{$w$ is a subword of $u$}} \]
and $w$ is a \defword{subword} of $u$ for $w,u \in \Sigma^*$ iff there is a subsequence $(s_n)_{n\in\N}$ of $(n)_{n\in\N}$ such that $w = u|_s$.

Define
\[ \Lang(\PT_n) := \Lang(\simeq_{\PT_n}). \]
Then the class of \defword{piecewise testable languages} is defined as
\[ \Lang(\PT) := \bigcup_{n\in\N} \Lang(\PT) . \]

We also have the characterization
\[ \Lang(\PT) = \BC \bigcup_{n\in\N_0,a_i \in \Sigma} \Set{\Sigma^* a_1 \Sigma^* a_2 \Sigma^* \cdots\Sigma^* a_n \Sigma^*} . \]
% The syntactic monoid is also J-trivial.

See \cite[Section 2.3]{ConcHierR104} for further references.

%S52: overview
%S212: BC lim class

$L$ piece-wise testable $\Leftrightarrow$ $L$ is a boolean algebra of $\Sigma^* a_1 \Sigma^* a_2 \dotsb a_n \Sigma^*$.

%S101:
\begin{theorem}
\label{thm.PT}
\[ \BC \ext \Lang^* (\PT) = \BC \lim \Lang^* (\PT) \]
\begin{proof}
$\subseteq$: It is sufficient to show $\ext(\Lang^* (\PT)) \subseteq \BC \lim \Lang^* (\PT)$.

By complete induction:
\begin{align*}
& \ext(\Sigma^* a_1 \Sigma^* a_2 \dotsb a_n \Sigma^*) = \Sigma^* a_1 \Sigma^* a_2 \dotsb a_n \Sigma^\omega = \lim(\Sigma^* a_1 \Sigma^* a_2 \dotsb a_n \Sigma^*) \\
& \ext( \neg ( \Sigma^* a_1 \Sigma^* a_2 \dotsb a_n \Sigma^* )) = \Sigma^\omega = \lim( \Sigma^* ) \\
& \ext( \emptyset ) = \emptyset = \lim(\emptyset)
\end{align*}

It is sufficient to show negation only for such ground terms because we can always push the negation down.
\begin{align*}
& \ext(A \cup B) = \ext(A) \cup \ext(B) \\
& \ext(A \cap B) = \ext(A) \cap \ext(B)
\end{align*}

This makes the induction complete.

$\supseteq$: It is sufficient to show $\lim(\Lang^* (\PT)) \subseteq \BC \ext \Lang^* (\PT)$.
\begin{align*}
& \lim(\emptyset) = \ext(\emptyset), \ \lim(\Sigma^* a_1 \Sigma^* a_2 \dotsb a_n \Sigma^*) = \ext(\Sigma^* a_1 \Sigma^* a_2 \dotsb a_n \Sigma^*) \ \ \text{(see above)} \\
& \begin{aligned}
\lim( \neg ( \Sigma^* a_1 \Sigma^* a_2 \dotsb a_n \Sigma^* ) ) & = \Set{ \alpha \in \Sigma^\omega }{ \exists^\omega n \colon \alpha [0,n] \notin \Sigma^* a_1 \Sigma^* a_2 \dotsb a_n \Sigma^* } \\
& = \Set{ \alpha \in \Sigma^\omega }{ \forall n \colon \alpha [0,n] \notin \Sigma^* a_1 \Sigma^* a_2 \dotsb a_n \Sigma^* } \\
& = \neg \ext( \Sigma^* a_1 \Sigma^* a_2 \dotsb a_n \Sigma^* )
\end{aligned} \\
& \begin{aligned}
\lim(A \cup B) & = \Set{ \alpha \in \Sigma^\omega }{ \exists^\omega n \colon \alpha[0,n] \in A \cup B } = \lim(A) \cup \lim(B) \\
\lim(A \cap B) & = \Set{ \alpha \in \Sigma^\omega }{ \exists^\omega n \colon \alpha[0,n] \in A \cap B } \\
\intertext{and because $A,B$ are piece-wise testable}
& = \Set{ \alpha \in \Sigma^\omega }{ \exists n : \forall m > n \colon \alpha[0,m] \in A \cap B } = \lim(A) \cap \lim(B)
\end{aligned}
\end{align*}
\end{proof}
\end{theorem}



\label{lang:posPT}
\defword{Positive piece-wise testable languages} are defined as
\[ \Lang(\mathtext{pos-PT}) := \operatorname{pos-BC} \bigcup_{n\in\N_0,a_i \in \Sigma} \Set{\Sigma^* a_1 \Sigma^* a_2 \Sigma^* \cdots\Sigma^* a_n \Sigma^*} . \]

For positive piece-wise testable (pos-PT) languages, we get the same result.
%\subsection{positive piece-wise testable}
%S53: overview
%S214: BC lim class

%S101:
\begin{theorem}
\label{thm.ext.lim.posPT}
\[ \BC \ext \Lang^* (\mathtext{pos-PT}) = \BC \lim \Lang^* (\mathtext{pos-PT}) \]
\begin{proof}
$\subseteq$: Exactly like the proof for PT except that we leave out the negated part.

$\supseteq$: Also like the proof for PT.
\end{proof}
\end{theorem}

We also have a relation between pos-PT and PT.

\begin{theorem}
\[ \BC \ext \Lang^*(\mathtext{pos-PT}) = \BC \ext \Lang^* (\mathtext{PT}) \]

\begin{proof}
In the proof of $\lim \Lang^*(\mathtext{PT}) \subseteq \BC \ext \Lang^* (\mathtext{PT})$ we actually proved $\BC \lim \Lang^*(\mathtext{PT}) \subseteq \BC \ext \Lang^* (\mathtext{pos-PT})$. Similiarly we also proved $\BC \ext \Lang^* (\mathtext{PT}) \subseteq \BC \lim \Lang^* (\mathtext{pos-PT})$.

With \cref{thm.PT} and \cref{thm.ext.lim.posPT} we get the claimed equality.
\end{proof}
\end{theorem}


\subsection{Locally testable languages}
\label{lang:LT}
%S16: def
Let $u,v \in \Sigma^*$. For $n \in \N$, define the congruence relation $\simeq_{\text{LT}_n}$:
\begin{alignat*}{3}
u \simeq_{\text{LT}_n} v \ \ \ && :\Leftrightarrow \ \ \ & \operatorname{left-Fact}_{<n}(u) = \operatorname{left-Fact}_{<n}(v) , \\
&&& \operatorname{right-Fact}_{<n}(u) = \operatorname{right-Fact}_{<n}(v) , \\
&&& \operatorname{Fact}_{n}(u) = \operatorname{Fact}_{n}(v) \\
&& \Leftrightarrow \ \ \ & u \simeq_{\text{endwise}_n} v , \\
&&& \operatorname{Fact}_n(u) = \operatorname{Fact}_n(v)
\end{alignat*}
where
\begin{align*}
\operatorname{left-Fact}_{<n}(v) & := \Set{w \in \Sigma^{<n}}{\text{$w$ is left-factor of $v$}} \\
\operatorname{right-Fact}_{<n}(v) & := \Set{w \in \Sigma^{<n}}{\text{$w$ is right-factor of $v$}} \\
\operatorname{Fact}_{n}(v) & := \Set{w \in \Sigma^{n}}{\text{$w$ is factor of $v$}}.
\end{align*}
For $v,w \in \Sigma^*$,
\begin{align*}
\text{$w$ is a \defword{left-factor} of $v$} & \ :\Leftrightarrow \ \exists u \in \Sigma^* \colon wu = v \\
\text{$w$ is a \defword{right-factor} of $v$} & \ :\Leftrightarrow \ \exists u \in \Sigma^* \colon uw = v \\
\text{$w$ is a \defword{factor} of $v$} & \ :\Leftrightarrow \ \exists u_1,u_2 \in \Sigma^* \colon u_1 w u_2 = v.
\end{align*}

Define
\[ \Lang(\LT_n) := \Lang(\simeq_{\text{LT}_n}) . \]
Then the class of \defword{locally testable languages} is defined as
\[ \Lang(\LT) := \bigcup_{n\in\N} \Lang(\LT_n) . \]

We also have the characterization
\[ \Lang(\LT) = \BC \bigcup_{u,v,w \in \Sigma^+} \Set{u\Sigma^*, \Sigma^* v, \Sigma^* w \Sigma^*, \Set{\epsilon}} . \]

See \cite[Section 2.5]{ConcHierR104} for further references.

\begin{theorem}
\[ \BC \ext \Lang^* (\LT) \subsetneqq \BC \lim \Lang^*(\LT)  \]

\begin{proof}
Let $w \in \Sigma^+$.
\begin{align*}
& \ext (w \Sigma^*) = \lim(w \Sigma^*) \\
& \ext( \Sigma^* w) = \Sigma^* w \Sigma^\omega = \lim( \Sigma^* w \Sigma^* ) \\
& \ext( \Sigma^* w \Sigma^*) = \Sigma^* w \Sigma^\omega = \lim( \Sigma^* w \Sigma^* )
\end{align*}
Thus we have
\[ \BC \ext \Lang^* (\LT) \subseteq \BC \lim \Lang^*(\LT) . \]
But we also have
\[ \lim(\Sigma^*) = (\Sigma^* w)^\omega \notin \BC \ext \Lang^* (\LT) . \]
\end{proof}
\end{theorem}

% TODO: I think R105... handles them?
\defword{Positive locally testable languages} are defined as
\[ \Lang(\mathtext{pos-LT}) = \operatorname{pos-BC} \bigcup_{u,v,w \in \Sigma^+} \Set{u\Sigma^*, \Sigma^* v, \Sigma^* w \Sigma^*, \Set{\epsilon}} . \]

\subsection{Locally threshold testable languages}
\label{lang:LTT}
%S17: def
% FinAutLogR109
Let $u,v \in \Sigma^*$. Let $k,r \in \N$, define the congruence relation $\simeq_{\text{LTT}^k_r}$:
\begin{alignat*}{3}
u \simeq_{\text{LTT}^k_r} v \ \ \ && :\Leftrightarrow \ \ \ & \operatorname{left-Fact}_{<n}(u) = \operatorname{left-Fact}_{<n}(v) , \\
&&& \operatorname{right-Fact}_{<n}(u) = \operatorname{right-Fact}_{<n}(v) , \\
&&& \begin{aligned}
\forall x \in \Sigma^{\le k} \colon & \operatorname{count-Fact}_x(u) = \operatorname{count-Fact}_x(v) < r \ \ \ \ \text{or} \\
& \min \Set{\operatorname{count-Fact}_x(u), \operatorname{count-Fact}_x(v)} \ge r
\end{aligned}
\end{alignat*}
where for $x \in \Sigma^*$, $\operatorname{count-Fact}_x(u)$ states how often $x$ occurs as a factor in $u$, formally
\[ \operatorname{count-Fact}_x(u) := \#\Set{n \in \N}{u[n,n+\vert x \vert - 1] = x} . \]
Define
\[ \Lang(\text{LTT}^k_r) := \Lang(\simeq_{\text{LTT}^k_r}). \]
Then the class of \defword{locally threshold testable languages} is defined as
\[ \Lang(\mathtext{LTT}) := \bigcup_{k,r\in\N} \Lang(\text{LTT}^k_r) . \]

Locally threshold testable languages are a generalization of locally testable language. We can see that
\[  \Lang(\LT) = \bigcup_{k\in\N} \Lang(\text{LTT}^k_1) . \]

For further references, see \cite[IV.3]{FinAutLogR109}.

In \cite[IV.3.3]{FinAutLogR109}, we can see that
\[  \Lang(\text{LTT}) = \Lang(\mathrm{FO[+1]}). \]
%\subsection{FO[+1]}
%def: S17
%S213: BC ext class
%215: BC lim class

%S103:
\begin{theorem}
\[ \Lang^\omega (\mathrm{FO[+1]}) = \BC \ext \Lang^*(\mathrm{FO[+1]}) \]
\begin{proof}
From \cite[Theorem 4.8]{LangAutLogicR102}, we know that each formular in FO[+1] is equivalent (for both finite and infinite words) to a boolean combination of statements ``sphere $\sigma \in \Sigma^+$ occurs $\geq n$ times''. That statement can be expressed by a sentence of the form
\[ \psi := \exists \overline{x_1} \dotsb \exists \overline{x_n} \varphi(\overline{x_1}, \dotsb, \overline{x_n}) \]
where each $\overline{x_i}$ is a $\abs{\sigma}$-tuple of variables and the formula $\varphi$ states:
\[
\bigwedge_{\mathclap{i,j \in \underline{n},\atop { i \neq j,\atop k,l \in \underline{\abs{\sigma}}}}} x_{i,k} \neq x_{j,l}
\ \wedge\ \bigwedge_{\mathclap{i \in \underline{n},\atop k \in \underline{\abs{\sigma}-1}}} x_{i,k+1} = x_{i,k} + 1
\ \wedge\ \bigwedge_{\mathclap{i \in \underline{n},\atop k \in \underline{\abs{\sigma}}}} Q_{\sigma_k} x_{i,k}
\]
For $\psi$, we have:
\[ \alpha \models \psi \Leftrightarrow \exists n \colon \alpha[0,n] \models \psi \ \ \text{for all } \alpha \in \Sigma^\omega , \]
i.e.
\[ L^\omega(\psi) = \ext L^*(\psi) . \]
Any formular in FO[+1] can be expressed as a boolean combination of $\psi$-like formular. With
\begin{align*}
& L^\omega(\neg \psi) = \neg L^\omega(\psi) \\
& L^\omega(\psi_1 \wedge \psi_2) = L^\omega(\psi_1) \cap L^\omega(\psi_2) \\
& L^\omega(\psi_1 \vee \psi_2) = L^\omega(\psi_1) \cup L^\omega(\psi_2)
\end{align*}
we get:
\[ \Lang^\omega(\mathrm{FO[+1]}) = \BC \ext \Lang^*(\mathrm{FO[+1]}). \]
\end{proof}
\end{theorem}

\subsection{FO[]}

\subsection{Endwise testable languages}
\label{lang:endwise}
%S20: def
Let $u,v \in \Sigma^*$. For $n \in \N$, define the congruence relation $\simeq_{\text{endwise}_n}$:
\begin{alignat*}{3}
u \simeq_{\text{endwise}_n} v \ \ \ && :\Leftrightarrow \ \ \ & \operatorname{left-Fact}_{<n}(u) = \operatorname{left-Fact}_{<n}(v) , \\
&&& \operatorname{right-Fact}_{<n}(u) = \operatorname{right-Fact}_{<n}(v)
\end{alignat*}
Then the class of \defword{endwise testable languages} is defined as
\[ \Lang(\mathtext{endwise}) := \bigcup_{n\in\N} \Lang(\simeq_{\text{endwise}_n}) . \]

We also have the characterization
\[ \Lang(\mathtext{endwise}) = \Set{X \Sigma^* Y \cup Z}{X,Y \subseteq \Sigma^+, Z \subseteq \Sigma^*, \text{$X,Y,Z$ finite}} . \]

See \cite[Section 2.4]{ConcHierR104} for further references.

%S104:
\begin{itemize}
\item $\BC \ext \Lang^*(\mathtext{endwise}) \neq \BC \lim \Lang^*(\mathtext{endwise})$ because $\Sigma^*a \in \Lang^*(\mathtext{endwise})$.
\item $\ext(a\Sigma^* a) = a \Sigma^* a \Sigma^\omega \notin \BC \lim \Lang^*(\mathtext{endwise})$
\end{itemize}

\subsection{Finite / Co-finite languages}
%S22: def
\label{lang:finite}

The class of finite $*$-languages is denoted by $\Lang(\mathtext{finite}$. The class of infinite $*$-languages is denoted by $\Lang(\mathtext{co-finite})$.

We get the following results:
%S105:
\begin{itemize}
\item $\lim \Lang^*(\mathtext{finite}) = \Set{\emptyset}$
\item $\ext \Lang^*(\mathtext{finite}) = \Lang^*(\mathtext{finite}) \cdot \Sigma^\omega$
\item $\lim \Lang^*(\mathtext{co-finite}) = \Set{\Sigma^\omega}$
\item $\ext \Lang^*(\mathtext{co-finite}) = \Set{\Sigma^\omega}$
\end{itemize}

Thus, the usual inclusions don't hold at all here.

\subsection{Local languages}
\label{lang:local}
%S22: def
% TODO: quelle?
%The class of \defword{local $*$-languages} is defined as
%\[ \Lang(\mathtext{local}) := \Lang(\mathtext{finite}) \cup \Lang(\mathtext{co-finite}) . \]
A language $L \subseteq \Sigma^*$ is called \defword{local} iff there exist $P,S \subseteq \Sigma$, $N \subseteq \Sigma^2$ such that
\[ L - \Set{\epsilon} = (P\Sigma^* \cap \Sigma^* S) - (\Sigma^* N \Sigma^*). \]
For references, see \cite{Berstel1996439}.

\subsection{Regular languages of dot-depth-$n$}
\label{lang:dotdepth}
%S21: def
For any $n \in \N_0, r \in \N$, define recursively the set $\mathcal{B}_{n,r}$ of \emph{dot-depth $n$ languages with products of length $\le r$}:
\begin{align*}
\mathcal{B}_{0,r} & := \BC \Set{\Set{w}}{w \in \Sigma^{\le r}} \\
\mathcal{B}_{n+1,r} & := \BC \Set{B_1 \cdot \dotsc \cdot B_r}{B_i \in \mathcal{B}_{n,r}}
\end{align*}
Then, define the language class of \defword{dot-depth-$n$}
\[ \Lang(\mathtext{dot-depth-$n$}) := \bigcup_{r\in\N} \mathcal{B}_{n,r} . \]
For references, see \cite{ConcatGameDotDepth}.

\subsection{$L$-trivial languages}
\label{lang:Ltrivial}
\subsection{$R$-trivial languages}
\label{lang:Rtrivial}
%S23: def
\subsection{Locally modulo testable languages}
\label{lang:LmodT}
%S24: def

%\subsection{$k$-locally testable}

\subsection{Context free languages}
\label{lang:contextfree}


